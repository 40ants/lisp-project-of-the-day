<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html lang='en'>
  <head>
    <meta charset='utf-8' />
    <title>cl-tui
    </title>
    <link rel='alternate' href='https://40ants.com/lisp-project-of-the-day/rss.xml' type='application/rss+xml' />
    <meta name='viewport' content='width=device-width, initial-scale=1' />
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-162105820-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
  
    gtag('config', 'UA-162105820-1');
  </script>
  
    <link type='text/css' rel='stylesheet' href='https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css' />
    <script src='https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js'></script>
    <script src='https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js'></script>
    <link rel='stylesheet' href='../../highlight/styles/tomorrow-night.css' />
    <script src='../../highlight/highlight.pack.js'></script>
    <script>hljs.initHighlightingOnLoad();
    </script>
    <style>

.tags .label {
    margin-right: 1em;
}
.posts tr {
    line-height: 1.7em;
}
.posts tr td.number {
    font-weight: bold;
    padding-right: 0.7em;
}
.posts tr td.tags {
    padding-left: 0.7em;
}
h1 .tags {
    font-size: 1.2rem;
    position: relative;
    left: 1.5rem;
    top: -1.5rem;
}
.tags a {
    text-decoration: none;
}

    </style>
  </head>
  <body><div class='container'><div class='row'><a href='https://40ants.com/lisp-project-of-the-day/rss.xml' style='display: block; float: right;'><img alt='RSS Feed' src='https://40ants.com/lisp-project-of-the-day/media/images/rss.png' /></a><header><h1 style='text-align: center'><a href='../../index.html'>Lisp Project of the Day</a></h1><h2 style='text-align: center'>cl-tui</h2></header><div class='col-md-12 col-md-offset-0'><center><h3>You can support this project by donating at:</h3><a href='https://www.patreon.com/bePatron?u=33868637'><img alt='Donate using Patreon' src='https://40ants.com/lisp-project-of-the-day/media/images/patreon-btn.png' width='160' /></a><a href='https://liberapay.com/poftheday/donate'><img alt='Donate using Liberapay' src='https://liberapay.com/assets/widgets/donate.svg' /></a></center><h1>cl-tui<span class='tags'><a href='../../tags/console.html'><span class='label label-default'>console</span></a><a href='../../tags/ui.html'><span class='label label-default'>ui</span></a></span></h1><table style='position: relative; float: right; background-color: #F1F1F1; padding: 1em; margin-left: 1em; margin-bottom: 1em; border: 1px solid #D1D1D1;'><tr><td style='padding-left: 0.5rem; padding-right: 0.5rem'>Documentation</td><td style='padding-left: 0.5rem; padding-right: 0.5rem; border-left: 1px solid #DDD'>&#x1F97A;</td></tr><tr><td style='padding-left: 0.5rem; padding-right: 0.5rem'>Docstrings</td><td style='padding-left: 0.5rem; padding-right: 0.5rem; border-left: 1px solid #DDD'>&#x1F97A;</td></tr><tr><td style='padding-left: 0.5rem; padding-right: 0.5rem'>Tests</td><td style='padding-left: 0.5rem; padding-right: 0.5rem; border-left: 1px solid #DDD'>   &#x1F97A;</td></tr><tr><td style='padding-left: 0.5rem; padding-right: 0.5rem'>Examples</td><td style='padding-left: 0.5rem; padding-right: 0.5rem; border-left: 1px solid #DDD'>&#x1F600;</td></tr><tr><td style='padding-left: 0.5rem; padding-right: 0.5rem'>RepositoryActivity</td><td style='padding-left: 0.5rem; padding-right: 0.5rem; border-left: 1px solid #DDD'>&#x1F600;</td></tr><tr><td style='padding-left: 0.5rem; padding-right: 0.5rem'>CI</td><td style='padding-left: 0.5rem; padding-right: 0.5rem; border-left: 1px solid #DDD'>      &#x1F600;</td></tr></table><p>This system is an experimental user interface library for the console. It uses <a href="https://40ants.com/lisp-project-of-the-day/2020/05/0061-cl-charms.html">cl-charms</a> under the hood, to call <code>ncurses</code>. The library is not in Quicklisp yet but is installable from <a href="https://ultralisp.org">https://ultralisp.org</a></p>
<p>It contains a few examples. I've modified one to implement a simple chat-like interface:</p>
<pre><code class='text'>&#x250C;&#x2500;&#x2500;Online&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2510;
&#x2502;Bob               &#x2502;
&#x2502;Alice             &#x2502;
&#x2502;Peter             &#x2502;
&#x2502;Lisper 313373     &#x2502;23:08:46 Enter some text.
&#x2502;                  &#x2502;23:08:46 Esc to quit
&#x2502;                  &#x2502;23:08:52 Hello Lisp World!
&#x2502;                  &#x2502;23:09:05 This is a simple chat using
&#x2502;                  &#x2502;23:09:16 cl-tui and charms.
&#x2514;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2518;&gt; Input box</code></pre><p><code>cl-tui</code> allows defining frames which can be stacked together. And you can write text inside the frame. Hope, there will be more primitives for other GUI elements like buttons text inputs, forms etc.</p>
<p>Here are pieces of the example. First, I defined a "roster" and a function to render it inside a frame. This function also draws a border around:</p>
<pre><code class='lisp'>(defvar *roster* &#039;(&quot;Bob&quot;
                   &quot;Alice&quot;
                   &quot;Peter&quot;
                   &quot;Lisper 313373&quot;))

(defun draw-roster (&amp;key frame)
  (draw-box frame)
  (put-text frame 0 3 &quot;Online&quot;)
  
  (loop for name in *roster*
        for row upfrom 1
        do (put-text frame row 1 name)))</code></pre><p>Next part is the code defining the application's layout. It is constructed from nested frames of different types. There is a frame for our roster, a frame to display chat log and to get user's input:</p>
<pre><code class='lisp'>(define-frame main (container-frame :split-type :horizontal) :on :root)

(define-frame roster (simple-frame :render #&#039;draw-roster) :on main :w 20)

(define-frame chat (container-frame :split-type :vertical) :on main)

(define-frame log (log-frame) :on chat)

;; Edit-frame implements a single-line text editor.
;; It will misbehave if its height is not 1.
(define-frame input (edit-frame :prompt &quot;&gt; &quot;) :on chat :h 1)</code></pre><p>We also need two functions to add users input into the chat window and to process keystrokes:</p>
<pre><code class='lisp'>(defun finish-input ()
  ;; Get text from edit-frame
  (let ((text (get-text &#039;input)))
    ;; Append it to the log-frame
    (append-line &#039;log text)
    ;; And clear the text in edit-frame
    (clear-text &#039;input)))


(defun start ()
  (with-screen ()
    (append-line &#039;log &quot;Enter some text.&quot;)
    (append-line &#039;log &quot;Esc to quit&quot;)
    (loop
      (refresh)
      (let ((key (read-key)))
        (case key
          ;; Esc and Newline are handled here
          (#\Esc (return))
          (#\Newline (finish-input))
          (:key-up (cl-tui:scroll-log &#039;log 1))
          (:key-down (cl-tui:scroll-log &#039;log -1))
          ;; Everything else is sent to the edit-frame.
          (t (handle-key &#039;input key)))))))</code></pre><p>That is all the app.</p>
<p>Checkout <a href="https://github.com/naryl/cl-tui">the repository</a>. There you'll find more examples!</p>
<p>For those, who are interested in using nurses, here are reviews of the two lower-level libraries:</p>
<ul><li><a href="https://40ants.com/lisp-project-of-the-day/2020/05/0059-cl-ncurses.html">cl-ncurses</a></li><li><a href="https://40ants.com/lisp-project-of-the-day/2020/05/0061-cl-charms.html">cl-charms</a></li></ul>

<script src="https://utteranc.es/client.js"
        repo="40ants/lisp-project-of-the-day"
        issue-term="title"
        label="comments"
        theme="github-light"
        crossorigin="anonymous"
        async>
</script>
</div></div><div><hr /><center><p>Brought to you by 40Ants under&nbsp;<a rel='license' href='http://creativecommons.org/licenses/by-sa/4.0/'><img alt='Creative Commons License' style='border-width:0' src='https://i.creativecommons.org/l/by-sa/4.0/88x31.png' /></a></p></center></div></div>
  </body>
</html>